function a58_0x41bc(){const _0x5ad5ea=['clthH','percy.json','nGdRX','16148259QVARkJ','pELRE','JdIhe','bAOqX','pShDh','nodeRequest','pMFun','./PercyBinary','flags','VjunQ','Percy\x20config\x20created\x20at\x20','fetchPercyToken','ieqPJ','dtjBA','cNSoJ','zEnuV','xfrGa','zTzIl','FoDqk','percy.log','push','YqfHr','healthcheck','SLRkY','ZehQQ','stop','Error\x20creating\x20percy\x20config:\x20','3963376jQnNRl','close','Percy\x20healthcheck\x20successful','writeFile','sJUOF','NNtgw','Razsd','rfQau','ZIFAZ','&type=','10362sLvpMV','app:exec','4bYJbqM','getBinaryPath','GET','tmpdir','start','exec:stop','UVHzk','iOuEg','aaWsx','dQbvc','ocwqg','Dkuxz','BSsrH','token','gvXUV','LLFUl','zCWTo','dhhDw','utOCy','http://localhost:5338','YTwSo','stringify','path','isProcessRunning','PDltp','api/app_percy/get_project_token?name=','Percy\x20unable\x20to\x20fetch\x20project\x20token:\x20','maxHr','../logger','pspuh','createWriteStream','292456swyhbx','iUgbH','stdout','ZWvmi','BMOBA','PERCY_SERVER_ADDRESS','5256414pgMQZv','aCLAG','ZTJiG','3047910Nderbu','vxxhE','dITZV','createPercyConfig','JbaCZ','data','LzNzs','vXShq','ciSVp','RUMQh','YaBwS','env',':start','eYUWw','isRunning','duVnd','wIoyS','pipe','exec','winstonLogger','join','AyMHc','vkXtR','XZWie','182mhjeCL','tjylL','2351856lfqjdi','OmzXG','dLtqd','error','cTjTI','rVdVw','Jplwy','xOTZh','version','NMqtG','jopwm','debug','OxdKq','app','NZiyQ','tRCXf','automate','qVYQv','tBXSw'];a58_0x41bc=function(){return _0x5ad5ea;};return a58_0x41bc();}const a58_0x452f96=a58_0x2769;(function(_0x372a37,_0x14a933){const _0x5033b5=a58_0x2769,_0x2d3adb=_0x372a37();while(!![]){try{const _0x4313e3=parseInt(_0x5033b5(0x183))/0x1*(parseInt(_0x5033b5(0x185))/0x2)+-parseInt(_0x5033b5(0x1c7))/0x3+-parseInt(_0x5033b5(0x179))/0x4+parseInt(_0x5033b5(0x1ad))/0x5+-parseInt(_0x5033b5(0x1aa))/0x6+parseInt(_0x5033b5(0x1c5))/0x7*(parseInt(_0x5033b5(0x1a4))/0x8)+parseInt(_0x5033b5(0x15e))/0x9;if(_0x4313e3===_0x14a933)break;else _0x2d3adb['push'](_0x2d3adb['shift']());}catch(_0x5de1cf){_0x2d3adb['push'](_0x2d3adb['shift']());}}}(a58_0x41bc,0xb0cce));function a58_0x2769(_0x3cfa68,_0x8c3237){const _0x41bc14=a58_0x41bc();return a58_0x2769=function(_0x27697a,_0x6de877){_0x27697a=_0x27697a-0x14e;let _0x3ac951=_0x41bc14[_0x27697a];return _0x3ac951;},a58_0x2769(_0x3cfa68,_0x8c3237);}const fs=require('fs'),path=require(a58_0x452f96(0x19b)),os=require('os'),{spawn}=require('child_process'),helper=require('../helper'),logger=require('../logger')[a58_0x452f96(0x1c0)],{logDir}=require(a58_0x452f96(0x1a1)),PercyBinary=require(a58_0x452f96(0x165));class Percy{#logfile=path[a58_0x452f96(0x1c1)](logDir,a58_0x452f96(0x171));#address=process[a58_0x452f96(0x1b8)][a58_0x452f96(0x1a9)]||a58_0x452f96(0x198);#binaryPath=null;#config=null;#proc=null;#isApp=![];[a58_0x452f96(0x19c)]=![];constructor(_0x4dc4cd){const _0x2974a7=a58_0x452f96,_0x13c6ff={};_0x13c6ff[_0x2974a7(0x1c2)]=_0x2974a7(0x17b),_0x13c6ff[_0x2974a7(0x1ae)]=function(_0x38e6c6,_0x219131){return _0x38e6c6===_0x219131;},_0x13c6ff[_0x2974a7(0x1c4)]=_0x2974a7(0x161),_0x13c6ff[_0x2974a7(0x16c)]='WkGEG';const _0x5b4afb=_0x13c6ff;this.#config=_0x4dc4cd;if(!!_0x4dc4cd[_0x2974a7(0x155)]){if(_0x5b4afb[_0x2974a7(0x1ae)](_0x5b4afb[_0x2974a7(0x1c4)],_0x5b4afb[_0x2974a7(0x16c)]))return _0x1ef370[_0x2974a7(0x153)](_0x5b4afb['AyMHc']),!![];else this.#isApp=!![];}}async #getBinaryPath(){const _0x369fdc=a58_0x452f96,_0x27985b={};_0x27985b[_0x369fdc(0x195)]=function(_0x57decb,_0x5e7ab8){return _0x57decb===_0x5e7ab8;},_0x27985b[_0x369fdc(0x1b1)]='eCsCp';const _0x2bc0cc=_0x27985b;if(!this.#binaryPath){if(_0x2bc0cc[_0x369fdc(0x195)](_0x2bc0cc[_0x369fdc(0x1b1)],_0x2bc0cc[_0x369fdc(0x1b1)])){const _0x7efea3=new PercyBinary();this.#binaryPath=await _0x7efea3[_0x369fdc(0x186)](this.#config);}else return![];}return this.#binaryPath;}async #sleep(_0x5ee422){return new Promise(_0x4d4ab6=>setTimeout(_0x4d4ab6,_0x5ee422));}async[a58_0x452f96(0x174)](){const _0x19fc70=a58_0x452f96,_0x14e11e={'ocwqg':function(_0x5bf911,_0x2c73d5){return _0x5bf911(_0x2c73d5);},'clthH':function(_0x475301,_0xc2fc45){return _0x475301+_0xc2fc45;},'tBXSw':_0x19fc70(0x168),'nwaXd':function(_0xdce1aa,_0x3b2f67){return _0xdce1aa(_0x3b2f67);},'AiPEU':function(_0x19b3e6,_0x34657e){return _0x19b3e6!==_0x34657e;},'LzNzs':_0x19fc70(0x162),'Razsd':_0x19fc70(0x194),'xOTZh':_0x19fc70(0x187),'vXShq':'percy/healthcheck','ZlUyb':function(_0x217126,_0x2292f9){return _0x217126!==_0x2292f9;},'qVYQv':'aXOhf','wMSMJ':function(_0x236ddd,_0xa955d5){return _0x236ddd!==_0xa955d5;},'YaBwS':'kmzMd'};try{if(_0x14e11e['AiPEU'](_0x14e11e[_0x19fc70(0x1b3)],_0x14e11e[_0x19fc70(0x17f)])){const _0x28185c=await helper[_0x19fc70(0x163)](_0x14e11e[_0x19fc70(0x14f)],_0x14e11e[_0x19fc70(0x1b4)],null,null,this.#address);if(_0x28185c)return _0x14e11e['ZlUyb'](_0x14e11e[_0x19fc70(0x159)],_0x14e11e[_0x19fc70(0x159)])?null:!![];}else return this[_0x19fc70(0x19c)];}catch(_0x26a68a){if(_0x14e11e['wMSMJ'](_0x14e11e[_0x19fc70(0x1b7)],_0x14e11e[_0x19fc70(0x1b7)]))_0x43a7be&&(_0x467a25[_0x19fc70(0x1ca)](_0x19fc70(0x178)+_0xb9c0ea),_0x14e11e[_0x19fc70(0x18f)](_0x1eb3f0,null)),_0x23c8c0[_0x19fc70(0x153)](_0x14e11e[_0x19fc70(0x15b)](_0x14e11e[_0x19fc70(0x15a)],_0xa9d0d3)),_0x14e11e['nwaXd'](_0x4c4588,_0xa43d2d);else return![];}}async[a58_0x452f96(0x189)](){const _0x136e54=a58_0x452f96,_0xf83c2c={'zTzIl':function(_0x112693,_0x498211){return _0x112693(_0x498211);},'duVnd':function(_0x5e5a4b,_0x35d757){return _0x5e5a4b!==_0x35d757;},'yTYhm':_0x136e54(0x18e),'jGVRF':'TjTEf','RUMQh':function(_0x1cff29,_0x180bfa){return _0x1cff29===_0x180bfa;},'CJzrr':'ZjMwF','gvXUV':_0x136e54(0x184),'qchkI':_0x136e54(0x1bf),'iOuEg':_0x136e54(0x157),'JdIhe':function(_0x716d46,_0x527aa0,_0x22bf08,_0x590059){return _0x716d46(_0x527aa0,_0x22bf08,_0x590059);},'NMqtG':_0x136e54(0x17a),'maxHr':_0x136e54(0x152),'BSsrH':_0x136e54(0x1c6),'ZehQQ':_0x136e54(0x1a7),'utOCy':_0x136e54(0x17b)},_0x192e21=await this.#getBinaryPath(),_0x123ab8={};_0x123ab8[_0x136e54(0x166)]='a';const _0x5aaf1b=fs[_0x136e54(0x1a3)](this.#logfile,_0x123ab8),_0x349395=await this[_0x136e54(0x169)](),_0x422c5f=await this['createPercyConfig']();if(!_0x349395){if(_0xf83c2c[_0x136e54(0x1b6)](_0xf83c2c['CJzrr'],_0xf83c2c['CJzrr']))return![];else this[_0x136e54(0x19c)]=![],_0xf83c2c[_0x136e54(0x16f)](_0x2dd4e7,_0x150acf);}const _0x26b29b=[(this.#isApp?_0xf83c2c[_0x136e54(0x193)]:_0xf83c2c['qchkI'])+_0x136e54(0x1b9)];if(_0x422c5f){if(_0xf83c2c[_0x136e54(0x1b6)](_0xf83c2c[_0x136e54(0x18c)],_0xf83c2c[_0x136e54(0x18c)]))_0x26b29b[_0x136e54(0x172)]('-c',_0x422c5f);else return!![];}const _0x13b8bb={};_0x13b8bb['PERCY_TOKEN']=_0x349395,this.#proc=_0xf83c2c[_0x136e54(0x160)](spawn,_0x192e21,_0x26b29b,{'env':Object['assign'](process[_0x136e54(0x1b8)],_0x13b8bb)}),this.#proc[_0x136e54(0x1a6)][_0x136e54(0x1be)](_0x5aaf1b),this.#proc['stderr'][_0x136e54(0x1be)](_0x5aaf1b),this[_0x136e54(0x19c)]=!![];var _0x57d060=this;this.#proc['on'](_0xf83c2c[_0x136e54(0x151)],function(_0x407755){const _0x3ddd6b=_0x136e54;if(_0xf83c2c[_0x3ddd6b(0x1bc)](_0xf83c2c['yTYhm'],_0xf83c2c['jGVRF']))_0x57d060['isProcessRunning']=![];else return _0x219021[_0x3ddd6b(0x1ca)](_0x3ddd6b(0x19f)+_0x3be749),null;});do{if(_0xf83c2c[_0x136e54(0x1b6)](_0xf83c2c[_0x136e54(0x1a0)],_0xf83c2c[_0x136e54(0x1a0)])){const _0x1c405d=await this[_0x136e54(0x174)]();if(_0x1c405d){if(_0xf83c2c['duVnd'](_0xf83c2c[_0x136e54(0x191)],_0xf83c2c[_0x136e54(0x176)]))return logger[_0x136e54(0x153)](_0xf83c2c[_0x136e54(0x197)]),!![];else _0x2519e2['isProcessRunning']=![];}await this.#sleep(0x3e8);}else return![];}while(this[_0x136e54(0x19c)]);return![];}async[a58_0x452f96(0x177)](){const _0x5420cc=a58_0x452f96,_0x34ff60={'yWwwS':function(_0x2c8ff9,_0x2e9f1a){return _0x2c8ff9(_0x2e9f1a);},'rfQau':function(_0x11a398,_0x1c9515){return _0x11a398===_0x1c9515;},'vkXtR':_0x5420cc(0x18d),'sJUOF':function(_0x1c3100,_0x4e92ec){return _0x1c3100!==_0x4e92ec;},'wIoyS':'zECtU','BMOBA':function(_0x49a70b,_0x391dd0,_0x524a40){return _0x49a70b(_0x391dd0,_0x524a40);},'UVHzk':_0x5420cc(0x18a),'IThlB':_0x5420cc(0x17a)},_0x14efac=await this.#getBinaryPath();return new Promise((_0x16c4bc,_0x595a3f)=>{const _0x77861a=_0x5420cc,_0x456538={'Jplwy':function(_0x1c4980,_0x38164c){return _0x34ff60['yWwwS'](_0x1c4980,_0x38164c);},'pELRE':function(_0x35062a,_0x429e2f){const _0x235fe9=a58_0x2769;return _0x34ff60[_0x235fe9(0x180)](_0x35062a,_0x429e2f);},'OmzXG':_0x34ff60[_0x77861a(0x1c3)]};if(_0x34ff60[_0x77861a(0x17d)](_0x34ff60[_0x77861a(0x1bd)],_0x34ff60[_0x77861a(0x1bd)]))_0x3b0685[_0x77861a(0x1ca)](_0x77861a(0x178)+_0x5db935),_0x456538[_0x77861a(0x14e)](_0x26bcb3,null);else{const _0x26ebd7=_0x34ff60[_0x77861a(0x1a8)](spawn,_0x14efac,[_0x34ff60[_0x77861a(0x18b)]]);_0x26ebd7['on'](_0x34ff60['IThlB'],_0x102f63=>{const _0x2656de=_0x77861a;_0x456538[_0x2656de(0x15f)](_0x456538[_0x2656de(0x1c8)],_0x456538['OmzXG'])?(this[_0x2656de(0x19c)]=![],_0x456538[_0x2656de(0x14e)](_0x16c4bc,_0x102f63)):_0x484b7d[_0x2656de(0x150)]='2';});}});}[a58_0x452f96(0x1bb)](){const _0x11e792=a58_0x452f96;return this[_0x11e792(0x19c)];}async['fetchPercyToken'](){const _0x1c6e2b=a58_0x452f96,_0x54d185={'zEnuV':function(_0x5e3cde,_0x3cdd32){return _0x5e3cde(_0x3cdd32);},'Dkuxz':function(_0x140fd5,_0x29a345){return _0x140fd5+_0x29a345;},'dtjBA':_0x1c6e2b(0x168),'nGdRX':function(_0x5c70d6,_0x30703d){return _0x5c70d6!==_0x30703d;},'NNtgw':_0x1c6e2b(0x1cb),'tfZCs':_0x1c6e2b(0x167),'pMFun':_0x1c6e2b(0x155),'ZIFAZ':_0x1c6e2b(0x158),'xfrGa':_0x1c6e2b(0x187),'dhhDw':'Percy\x20fetch\x20token\x20success','pspuh':function(_0x11014c,_0x46356d){return _0x11014c===_0x46356d;},'cbFVx':'ZQGKi','NZiyQ':_0x1c6e2b(0x16a)},_0x55ecb5=this.#config['projectName'];try{if(_0x54d185[_0x1c6e2b(0x15d)](_0x54d185[_0x1c6e2b(0x17e)],_0x54d185['tfZCs'])){const _0x1f1e6c=this.#isApp?_0x54d185[_0x1c6e2b(0x164)]:_0x54d185[_0x1c6e2b(0x181)],_0x153c8f=await helper[_0x1c6e2b(0x163)](_0x54d185[_0x1c6e2b(0x16e)],_0x1c6e2b(0x19e)+_0x55ecb5+_0x1c6e2b(0x182)+_0x1f1e6c,{},this.#config),_0xf43a2a=_0x153c8f[_0x1c6e2b(0x1b2)];return logger[_0x1c6e2b(0x153)](_0x54d185[_0x1c6e2b(0x196)]),_0xf43a2a[_0x1c6e2b(0x192)];}else _0x55d103[_0x1c6e2b(0x172)]('-c',_0x148008);}catch(_0x57cdfc){if(_0x54d185[_0x1c6e2b(0x1a2)](_0x54d185['cbFVx'],_0x54d185[_0x1c6e2b(0x156)]))_0x229386[_0x1c6e2b(0x17c)](_0x3a363c,_0x5938f8[_0x1c6e2b(0x19a)](_0x5ab7c4),_0x3f28fa=>{const _0x460ded=_0x1c6e2b;_0x3f28fa&&(_0x1b4344['error'](_0x460ded(0x178)+_0x3f28fa),_0x54d185[_0x460ded(0x16d)](_0x2a541c,null)),_0x49a8dc['debug'](_0x54d185[_0x460ded(0x190)](_0x54d185[_0x460ded(0x16b)],_0x50978b)),_0x54d185[_0x460ded(0x16d)](_0x35db3b,_0x18dd4a);});else return logger[_0x1c6e2b(0x1ca)](_0x1c6e2b(0x19f)+_0x57cdfc),null;}}async[a58_0x452f96(0x1b0)](){const _0x50d9a7=a58_0x452f96,_0x50f3c0={'rfSjH':function(_0x500f0b,_0x493f20){return _0x500f0b(_0x493f20);},'WSjju':function(_0x5e66af,_0x316982,_0x29ead3){return _0x5e66af(_0x316982,_0x29ead3);},'YqfHr':'exec:stop','PDltp':_0x50d9a7(0x17a),'ZTJiG':function(_0x4c215e,_0x87b510){return _0x4c215e(_0x87b510);},'iUgbH':function(_0x9da38e,_0x55c4a0){return _0x9da38e+_0x55c4a0;},'ciSVp':_0x50d9a7(0x168),'dLtqd':function(_0x32d5bf,_0x198837){return _0x32d5bf!==_0x198837;},'aREFM':'AeMAR','dITZV':_0x50d9a7(0x1ab),'OxdKq':_0x50d9a7(0x15c),'TyxHI':function(_0x4fc030,_0x82d88a){return _0x4fc030===_0x82d88a;},'dfIHV':_0x50d9a7(0x1ba),'YTwSo':_0x50d9a7(0x175)};if(!this.#config['percyOptions'])return _0x50f3c0[_0x50d9a7(0x1c9)](_0x50f3c0['aREFM'],_0x50f3c0[_0x50d9a7(0x1af)])?null:new _0x41baf5(_0x3cea9f=>_0x34f21c(_0x3cea9f,_0x1b62bd));const _0x47ba05=path['join'](os[_0x50d9a7(0x188)](),_0x50f3c0[_0x50d9a7(0x154)]),_0x1bc274=this.#config['percyOptions'];if(!_0x1bc274[_0x50d9a7(0x150)]){if(_0x50f3c0['TyxHI'](_0x50f3c0['dfIHV'],_0x50f3c0[_0x50d9a7(0x199)])){const _0x14fe92={'FoDqk':function(_0x59a043,_0x1f66cb){return _0x50f3c0['rfSjH'](_0x59a043,_0x1f66cb);}},_0x47612e=_0x50f3c0['WSjju'](_0x41d72b,_0x1e5a58,[_0x50f3c0[_0x50d9a7(0x173)]]);_0x47612e['on'](_0x50f3c0[_0x50d9a7(0x19d)],_0x237180=>{const _0x1bebc1=_0x50d9a7;this['isProcessRunning']=![],_0x14fe92[_0x1bebc1(0x170)](_0x37b285,_0x237180);});}else _0x1bc274[_0x50d9a7(0x150)]='2';}return new Promise((_0x1219bd,_0x1b1fa4)=>{const _0x1693ec=_0x50d9a7,_0x545d16={'btrdF':function(_0x5c00a5,_0xf8ca3){const _0x5d4030=a58_0x2769;return _0x50f3c0[_0x5d4030(0x1ac)](_0x5c00a5,_0xf8ca3);},'rVdVw':function(_0x309024,_0x52675b){const _0x3c6fb1=a58_0x2769;return _0x50f3c0[_0x3c6fb1(0x1a5)](_0x309024,_0x52675b);},'uFSgP':_0x50f3c0[_0x1693ec(0x1b5)]};fs[_0x1693ec(0x17c)](_0x47ba05,JSON[_0x1693ec(0x19a)](_0x1bc274),_0x58ca98=>{const _0x2f7ed0=_0x1693ec;_0x58ca98&&(logger['error'](_0x2f7ed0(0x178)+_0x58ca98),_0x545d16['btrdF'](_0x1219bd,null)),logger[_0x2f7ed0(0x153)](_0x545d16[_0x2f7ed0(0x1cc)](_0x545d16['uFSgP'],_0x47ba05)),_0x545d16['btrdF'](_0x1219bd,_0x47ba05);});});}}module['exports']=Percy;